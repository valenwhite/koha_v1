---
// Import the main layout wrapper and background rain component
import BaseLayout from "../layouts/BaseLayout.astro";
import KOHARain from "../components/KOHARain.astro";
import KOHARainNoScale from "../components/KOHARainNoScale.astro";
import "../styles/global.css";
const titleMap = [
  { year: "2024", title: "MOTHER HOOD" },
  { year: "2020", title: "THE PACT" },
  { year: "2018", title: "THE TRICK" },
];
---

<!-- Layout wrapper for consistent page structure -->
<BaseLayout>
  <!-- Rain animation for desktop background (visible only on large screens) -->
  <div
    class="absolute hidden inset-0 opacity-60 -z-10 lg:block"
    style="left: 272px;"
  >
    <KOHARain />
  </div>

  <!-- Main content area with rotating image -->
  <div
    class="relative w-screen h-screen overflow-hidden lg:w-auto lg:h-auto lg:px-14 lg:pt-[100px]"
  >
    
    <!-- Image container -->
    <div
      class="relative w-full h-full lg:rounded lg:aspect-[4992/2072] overflow-hidden"
    >
      <!-- Image which updates every 6 seconds -->
      <img
        id="rotating-image"
        src="/images/mother_hood.jpg"
        alt="The Trick"
        class="fade-zoom-in relative mx-auto z-10 h-full w-full object-cover object-[78%_center]"
      />
    </div>

    <div
      id="shared-titles"
      class="absolute bottom-50 left-4 z-20 flex flex-col gap-10 lg:items-end lg:gap-0 lg:right-4 lg:flex lg:static lg:gap-0 lg:pt-3"
    >
      <h1
        id="shared-title"
        class="text-6xl soleil text-white lg:text-black text-left lg:text-right"
      >
      </h1>
      <p
        id="shared-year"
        class="font-sans font-semibold text-lg text-gray-200 lg:text-gray-500 text-left lg:text-right lg:self-end"
      >
      </p>
      <div
        class="fixed z-50 invert rotate-270  translate-x-36 -translate-y-75.5 scale-50 pointer-events-none select-none lg:hidden"
        aria-hidden="true"
      >
        <KOHARainNoScale />
      </div>
    </div>
  </div>

  <div
    class="hidden lg:block absolute inset-x-0 top-60 -z-10 transform-gpu overflow-hidden blur-3xl"
    aria-hidden="true"
  >
    <div
      class="relative left-1/2 -z-10 aspect-1155/678 w-144.5 max-w-none -translate-x-1/2 rotate-40 opacity-25 sm:left-[calc(50%-40rem)] sm:w-288.75 dynamic-bg"
      style="clip-path: polygon(74.1% 44.1%, 100% 61.6%, 97.5% 26.9%, 85.5% 0.1%, 80.7% 2%, 72.5% 32.5%, 60.2% 62.4%, 52.4% 68.1%, 47.5% 58.3%, 45.2% 34.5%, 27.5% 76.7%, 0.1% 64.9%, 17.9% 100%, 27.6% 76.8%, 76.1% 97.7%, 74.1% 44.1%)"
    >
    </div>
  </div>
</BaseLayout>

<script is:inline>
  const images = [
    "/images/mother_hood.jpg",
    "/images/the_pact.png",
    "/images/the_trick.png",
  ];

  const backgroundDiv = document.querySelector(".dynamic-bg");
  const bgStyles = [
    "from-[#d334d3] to-[#344ed3]", // mother_hood.jpg
    "from-[#344ed3] to-[#60a5fa]", // the_pact.png
    "from-[#d3a634] to-[#d36e34]", // the_trick.png
  ];

  const titleMap = [
    { year: "2024", title: "MOTHER HOOD" },
    { year: "2020", title: "THE PACT" },
    { year: "2018", title: "THE TRICK" },
  ];
  let activeIndex = 0;

  function updateTitles(index) {
    const img = document.getElementById("rotating-image");
    const titleEl = document.getElementById("shared-title");
    const yearEl = document.getElementById("shared-year");

    if (img) {
      img.src = images[index];
      img.classList.remove(
        "fade-in-right",
        "fade-in-std",
        "zoom-in",
        "fade-zoom-in"
      );
      void img.offsetWidth;
      img.classList.add("fade-zoom-in");
    }

    if (titleEl) {
      titleEl.textContent = titleMap[index].title;
    }

    if (yearEl) {
      yearEl.textContent = titleMap[index].year;
    }

    if (backgroundDiv) {
      backgroundDiv.className =
        "relative left-1/2 -z-10 aspect-1155/678 w-144.5 max-w-none -translate-x-1/2 rotate-30 opacity-20 sm:left-[calc(50%-40rem)] sm:w-288.75";
      backgroundDiv.classList.add(
        "bg-gradient-to-tr",
        ...bgStyles[index].split(" ")
      );
    }
  }

  // Initial update on load
  requestAnimationFrame(() => {
    updateTitles(activeIndex);
  });
  document.body.style.overflowY = "auto";

  // Cycle title and image every 6 seconds
  setInterval(() => {
    activeIndex = (activeIndex + 1) % titleMap.length;
    updateTitles(activeIndex);
  }, 6000);
</script>
